<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Driver Panel</title>
<style>
body { font-family: sans-serif; padding: 15px; background: #f7f7f7; }
.card { background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px; }
button { width: 100%; padding: 14px; font-size: 18px; border-radius: 8px; border: none; margin-top: 10px; cursor: pointer; }
#start { background: #2ecc71; color: white; }
#arrived { background: #f1c40f; }
#finish { background: #e74c3c; color: white; }
</style>
</head>
<body>

<h2>Driver Control Panel</h2>

<div class="card">
  <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏ñ:</label><br>
  <select id="driver">
    <option value="‡∏£‡∏ñ 1">üöö ‡∏£‡∏ñ 1</option>
    <option value="‡∏£‡∏ñ 2">üöö ‡∏£‡∏ñ 2</option>
    <option value="‡∏£‡∏ñ 3">üöö ‡∏£‡∏ñ 3</option>
  </select>
</div>

<div class="card">
  <button id="start" onclick="sendStatus('START')">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô üöÄ</button>
  <button id="arrived" onclick="sendStatus('ARRIVED')">‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ üìç</button>
  <button id="finish" onclick="sendStatus('FINISHED')">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏á‡∏≤‡∏ô üéâ</button>
</div>

<div id="status"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwA3WmspsHNp3eZMMxnWqlYNrsJMviTufU9xmwAGMLLlysOw8YCoZJB5JXxtvfxo3q70g/exec"; // ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Web App

function sendStatus(statusText) {
    document.getElementById("status").innerHTML = "<div class='card'>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...</div>";

    navigator.geolocation.getCurrentPosition(
        pos => {
            let payload = {
                driver: document.getElementById("driver").value,
                status: statusText,
                lat: pos.coords.latitude,
                lng: pos.coords.longitude
            };

            fetch(API_URL, {
                method: "POST",
                headers: {"Content-Type":"application/json"},
                body: JSON.stringify(payload)
            })
            .then(r => r.text())
            .then(t => {
                document.getElementById("status").innerHTML =
                    "<div class='card'>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úî<br>" + JSON.stringify(payload) + "</div>";
            })
            .catch(err => {
                document.getElementById("status").innerHTML =
                    "<div class='card'>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‚ùå<br>" + err + "</div>";
            });
        },
        err => {
            alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á GPS ‡πÑ‡∏î‡πâ: " + err.message);
        },
        { enableHighAccuracy: true, timeout: 5000 }
    );
}
</script>

</body>
</html>
